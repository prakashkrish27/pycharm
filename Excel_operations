import pandas as pd
import psycopg2 as pg
import mysql.connector as sql
import warnings as wr
from openpyxl import Workbook
from tabulate import tabulate
import numpy as np
src_conn = sql.connect(host="source.c74pc9qqlwja.us-east-1.rds.amazonaws.com", database = 'source',user="admin", passwd="admin2727",use_pure=True)
tgt_conn = pg.connect(host="target.c74pc9qqlwja.us-east-1.rds.amazonaws.com", dbname = 'target',user="postgres", password="admin2727")
wr.filterwarnings("ignore")
f = open("C:/Users/Prakash.Krishnan/OneDrive - ACS Solutions/Desktop/PyCharm/Source.txt",'r')
f1 = open("C:/Users/Prakash.Krishnan/OneDrive - ACS Solutions/Desktop/PyCharm/target.txt",'r')
for line in f:
    for line1 in f1:
        df_tgt = pd.read_sql_query(line1, con=tgt_conn)
        df_target = pd.DataFrame(df_tgt)
        print(df_target.to_string(index=False))
        with pd.ExcelWriter('C:/Users/Prakash.Krishnan/OneDrive - ACS Solutions/Desktop/PyCharm/output.xlsx', mode='a',
                            engine='openpyxl', if_sheet_exists='replace') as writer:
            df_target.to_excel(writer, sheet_name='sheet2', index=False)
    df_src = pd.read_sql_query(line, con=src_conn)
    df_source = pd.DataFrame(df_src)
    print(df_source.to_string(index=False))
    with pd.ExcelWriter('C:/Users/Prakash.Krishnan/OneDrive - ACS Solutions/Desktop/PyCharm/output.xlsx', mode='a',
                        engine='openpyxl', if_sheet_exists='replace') as writer:
        df_source.to_excel(writer, sheet_name='sheet1', index=False)
